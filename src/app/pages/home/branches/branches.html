<div class="container w-100 py-5 ">

  <!-- Section Title -->
  <div class="d-flex justify-content-between align-items-center mx-2 mb-4">

    <!-- العنصر الثاني -->
    <a [routerLink]="['/home/branches']"
      class="btn btn-link view-all-btn text-dark align-items-center gap-2 p-0 order-1 order-md-2 d-none d-md-flex"
      style="white-space: nowrap; margin-left: -25px; text-decoration: none; font-weight: 700;">
      <img src="assets/Images/circle-arrow-up-right-02 (2).svg" alt="{{ 'VIEW_ALL' | translate }}" width="25px">
      {{ 'VIEW_ALL' | translate }}
    </a>
    <!-- العنصر الأول -->
    <h1 class="section-title fw-bold fs-3 mb-0 order-2 order-md-1">
      {{ 'OUR_BRANCHES' | translate }}
    </h1>

  </div>




  <!-- Branch Filters -->
<!-- City Filters -->
<div class="branch-filters mb-4 px-1 py-3">
  @for (city of cities; track city.id) {
    <button 
      class="btn btn-outline-secondary rounded-3 fw-bold px-3 px-md-5 mb-2"
      [class.active]="selectedCity?.id === city.id"
      (click)="selectCity(city)">
      <span class="px-lg-0 px-3">
        {{ currentLang === 'ar' ? city.name_ar : city.name_en }}
        <!-- <small class="ms-1">({{ city.branchCount }})</small> -->
      </span>
    </button>
  }
</div>




  <!-- Carousel Wrapper -->
  <div class="carousel-wrapper position-relative px-2">



<div class="carousel-track-container overflow-hidden"
     (touchstart)="onTouchStart($event)"
     (touchend)="onTouchEnd($event)">
  <div class="carousel-track d-flex transition-transform"
       [ngStyle]="{
         'transform': currentLang === 'ar' 
            ? 'translateX(' + (branchSlideIndex * (100 / visibleBranchCards)) + '%)'
            : 'translateX(-' + (branchSlideIndex * (100 / visibleBranchCards)) + '%)',
         'transition': 'transform 0.5s ease'
       }">


        <!-- Carousel Items -->
        @for (l of locations; track l) {
        <div class="carousel-slide " [ngStyle]="{
         'flex': '0 0 calc(100% / ' + visibleBranchCards + ')',
         'max-width': 'calc(100% / ' + visibleBranchCards + ')'
       }">
          <div class="service-card position-relative">
            <div class="d-flex justify-content-between align-items-center mb-2 flex-row-reverse">
              <div class="text-start">
                <img src="assets/Images/call-02.svg" alt="" width="20px">
                {{ l.phone }}
              </div>
              <div class="branch-title fw-bold text-end">{{ l.title }}</div>

            </div>
            <img [src]="l.image" alt="Frame"
              style="position: absolute; bottom: -40px; left: -10px; width: 50px; z-index: 2; transform: rotate(280deg);">
            <div class="service-card-content text-end">
              <div class="branch-location mb-1 py-3">
                <img src="assets/Images/location-05.svg" alt="" width="20px">

                {{ l.location }}
              </div>
              
              <button class="btn btn-outline-light btn-sm rounded-pill mx-5 d-inline-flex align-items-center custom-fs"
                (click)="openMap(selectedBranch)">
                <span class="d-flex align-items-center tablet-text">
                  <img src="assets/Images/maps-location-01.svg" alt="" class="ms-2" style="height: 25px;" />
                  {{ 'VIEW_DIRECTIONS' | translate }}
                </span>
              </button>




            </div>
          </div>
        </div>
        }


      </div>
    </div>

    <!-- Navigation -->
    <div
      class="d-flex flex-column flex-md-row justify-content-center justify-content-md-between align-items-center px-6 mt-4 py-3">

      <!-- Dots -->
      <div class="d-flex gap-2 px-lg-4 justify-content-center align-items-center mt-3 px">
        @for (i of getBranchDotsArray(); track i) {
        <button (click)="goToBranchSlide(i)" class="dot-btn " [class.active-dot]="branchSlideIndex === i">
        </button>
        }
      </div>


      <div class="d-flex gap-2 px-4 d-none d-md-flex" dir="rtl">
        <button class="arrow-btn prev" (click)="nextSlide()" [disabled]="branchSlideIndex === 0">
        </button>

        <button class="arrow-btn next" (click)="prevSlide()" [disabled]="branchSlideIndex >= getMaxBranchSlideIndex()">
        </button>
      </div>



    </div>
  </div>