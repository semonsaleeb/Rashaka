<div class="container w-100 py-5 px-3" dir="rtl">

  <!-- Section Title -->
  <div class="d-flex justify-content-between align-items-center mx-3 mb-4">
    <!-- العنصر الأول (اليمين في RTL) -->
    <h1 class="section-title fw-bold fs-3 mb-0 order-2 order-md-1">فروعنا</h1>

    <!-- العنصر الثاني (اليسار في RTL) -->
    <a [routerLink]="['/home/branches']"
      class="btn btn-link view-all-btn text-dark align-items-center gap-2 p-0 order-1 order-md-2 d-none d-md-flex"
      style="white-space: nowrap;">
      <img src="assets/Images/circle-arrow-up-right-02 (2).svg" alt="عرض الكل" width="25px">
      عرض الكل
    </a>

  </div>



  <!-- Branch Filters -->
  <div class="branch-filters d-flex mb-4 px-2 py-3" dir="rtl">
    @for (branch of branches; track branch) {
    <button class="btn btn-outline-secondary rounded-3 px-5 mx-1 fw-bold" [class.active]="selectedBranch === branch"
      (click)="selectBranch(branch)">
      {{ branch }}
    </button>
    }
  </div>


  <!-- Carousel Wrapper -->
  <div class="carousel-wrapper position-relative px-2">



    <div class="carousel-track-container overflow-hidden">
      <div class="carousel-track d-flex transition-transform" [ngStyle]="{
    'transform': 'translateX(+' + (branchSlideIndex * (100 / visibleBranchCards)) + '%)',
    'transition': 'transform 0.5s ease'
  }" (touchstart)="onTouchStart($event)" (touchend)="onTouchEnd($event)">

        <!-- Carousel Items -->
        @for (l of locations; track l) {
        <div class="carousel-slide px-3" [ngStyle]="{
         'flex': '0 0 calc(100% / ' + visibleBranchCards + ')',
         'max-width': 'calc(100% / ' + visibleBranchCards + ')'
       }">
          <div class="service-card position-relative">
            <div class="d-flex justify-content-between align-items-center mb-2 flex-row-reverse">
              <div class="branch-title fw-bold text-end">{{ l.title }}</div>
              <div class="text-start">
                {{ l.phone }}
                <img src="assets/Images/call-02.svg" alt="" width="20px">
              </div>
            </div>
            <img [src]="l.image" alt="Frame"
              style="position: absolute; bottom: -40px; left: -10px; width: 50px; z-index: 2; transform: rotate(280deg);">
            <div class="service-card-content text-end">
              <div class="branch-location mb-1 py-3">
                {{ l.location }}
                <img src="assets/Images/location-05.svg" alt="" width="20px">
              </div>
              <button class="btn btn-outline-light  btn-sm rounded-pill mx-5 d-inline-flex align-items-center custom-fs">
                <span class="d-flex align-items-center tablet-text ">
                  عرض اتجاهات الموقع
                  <img src="assets/Images/maps-location-01.svg" alt="" class="ms-2" style="height: 25px;" />
                </span>

              </button>


            </div>
          </div>
        </div>
        }


      </div>
    </div>

    <!-- Navigation -->
    <div
      class="d-flex flex-column flex-md-row justify-content-center justify-content-md-between align-items-center px-5 mt-4 py-3">

      <!-- Dots -->
      <div class="d-flex gap-2 px-lg-4 justify-content-center align-items-center mt-3 px">
        @for (i of getBranchDotsArray(); track i) {
        <button (click)="goToBranchSlide(i)" class="dot-btn " [class.active-dot]="branchSlideIndex === i">
        </button>
        }
      </div>


      <div class="d-flex gap-2 px-4 d-none d-md-flex">
        <button class="arrow-btn prev" (click)="nextSlide()" [disabled]="branchSlideIndex === 0">
        </button>

        <button class="arrow-btn next" (click)="prevSlide()" [disabled]="branchSlideIndex >= getMaxBranchSlideIndex()">
        </button>
      </div>



    </div>
  </div>