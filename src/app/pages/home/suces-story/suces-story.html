<!-- قسم آراء العملاء (Carousel Mode) -->
@if (mode === 'carousel') {
<div>
  <div class="success-stories  p-5" style="background: linear-gradient(135deg, #081E25 0%, #0a2a33 100%);">

    <!-- العنوان -->
    <div class="d-flex justify-content-between align-items-center mb-4 flex-wrap px-lg-5 mx-lg-4">
      <h2 class="section-title mb-0" [ngClass]="currentLang === 'ar' ? 'text-start' : 'text-end'">
        {{ 'CLIENT_REVIEWS' | translate }}
      </h2>
    </div>

    <div class="client-reviews">

      <div class="carousel-custom-wrapper position-relative" (touchstart)="onTouchStart($event)"
        (touchend)="onTouchEnd($event, 'review')"  style="touch-action: pan-y;">


        <!-- الكروت -->
        <div class="review-deck d-flex justify-content-center align-items-center">
          <ng-container *ngFor="let review of reviews; let i = index">
            <div class="review-card-custom" [ngClass]="getReviewCardClass(i)">
              <div class="review-video">
                <ng-container *ngIf="review.video_url.includes('youtube'); else mp4">
                  <iframe [src]="review.video_url | safeUrl" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen></iframe>
                </ng-container>

                <ng-template #mp4>
                   <video controls preload="metadata">
                    <source [src]="review.video_url" type="video/mp4" />
                  </video>

                </ng-template>
              </div>

              <div class="review-info text-center mt-3">
                <h5 class="client-name">{{ review.client_name }}</h5>
              </div>
            </div>
          </ng-container>
        </div>

      </div>

      <!-- Dots + Arrows (برا الكروت لكن جوا نفس السيكشن) -->
      <div *ngIf="reviews.length > 0" class="dotsInMobile px-5 mx-4 arrow-position d-flex   flex-wrap">

        <!-- Dots -->
        <div class="d-flex gap-2">
          <button *ngFor="let review of reviews; let i = index" type="button" class="dot"
            [class.active]="i === currentReviewIndex" (click)="goToReview(i)" [attr.aria-label]="'Review ' + (i + 1)">
          </button>
        </div>

        <!-- Arrows -->
        <div class="d-flex gap-2" dir="ltr" *ngIf="!isMobile">
          <button class="arrow-btn prev" (click)="nextReview()"></button>
          <button class="arrow-btn next" (click)="prevReview()"></button>
        </div>

      </div>

    </div>
  </div>
</div>

}

<!-- قسم قصص النجاح (Grid Mode) -->
@if (mode === 'grid') {
<div>
  
   <div class="header-section"> <div class="container py-5"> <div class="header-content"> <h1 class="title">{{ 'SUCCESS_STORIES_TITLE' | translate }}</h1> <p class="subtitle" [innerHTML]="'SUCCESS_STORIES_SUBTITLE' | translate"></p> <!-- CTA Button --> <button class="btn btn-success cta-button" [routerLink]="['/reservation/all']"> <span class="arrow-icon"> <img src="assets/Images/circle-arrow-up-right-02.svg" alt="Arrow Icon"> {{ 'SUCCESS_STORIES_CTA' | translate }} </span> </button> </div> </div> <div class="header-gradient"></div> </div> <div class="success-stories px-5 p-5"> <h2 class="section-title mb-4 py-4 px-5 mx-4">قصص نجاح حقيقية من عملائنا</h2> <div class="carousel-custom-wrapper position-relative" (touchstart)="onTouchStart($event)" (touchend)="onTouchEnd($event, 'story')"> <div class="story-deck-grid d-flex justify-content-center align-items-center"> @for (story of stories; track story; let i = $index) { <div class="story-card-custom" [ngClass]="getStoryCardClass(i)"> <!-- الصور --> <div class="story-image-wrapper d-flex position-relative"> <!-- Before --> <div class="position-relative flex-fill text-center before"> <img [src]="story.before_image" alt="Before Image" class="story-image" /> <strong class="weight-label">الوزن السابق: {{story.before_weight}}</strong> </div> <!-- After --> <div class="position-relative flex-fill text-center after"> <img [src]="story.after_image" alt="After Image" class="story-image" /> <strong class="weight-label text-white">الوزن الحالي: {{story.after_weight}}</strong> </div> </div> <!-- النصوص تحت الصور --> <div class="story-info"> <strong class="client-name">{{story.client_name}}</strong> <!-- <p class="weight-change">{{story.weight_change}}</p> --> <p>{{story.story | truncate: 300}}</p> </div> </div> } </div> <!-- Custom Arrows and Dots الخاصة بقصص النجاح --> @if (stories.length > 0) { <div class="d-flex justify-content-between align-items-center mt-5 py-5"> <!-- Dots --> <div class="d-flex gap-2"> @for (story of stories; track story; let i = $index) { <button type="button" class="dot" [class.active]="i === currentStoryIndex" (click)="goToStory(i)" [attr.aria-label]="'Story ' + (i + 1)"> </button> } </div> <!-- Arrows --> <div class="d-flex gap-2" dir="ltr"> <button class="arrow-btn prev" (click)="prevStory()"></button> <button class="arrow-btn next" (click)="nextStory()"></button> </div> </div>
      }
    </div>
  </div>


  <app-checkup></app-checkup>
  <app-branches></app-branches>
  <app-downloadapp></app-downloadapp>
</div>
}
