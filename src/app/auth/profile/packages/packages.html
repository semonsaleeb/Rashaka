<div class="subscription-page" [dir]="currentLang === 'ar' ? 'rtl' : 'ltr'">

  <!-- حالة التحميل -->
  @if (isLoading) {
  <div class="text-center py-5">
    <div class="spinner-border text-success" role="status"></div>
  </div>
  }

  <!-- لو في اشتراك -->
  @if (!isLoading && activeSubscription) {
  <div class="row justify-content-center">
    <div class="col-md-8 d-flex gap-4">

      <!-- تفاصيل الاشتراك -->
      <div class="flex-grow-1 p-4 border rounded-3">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <span [class.text-success]="activeSubscription.status === 'active'"
                [class.text-warning]="activeSubscription.status === 'pending_activation'"
                [class.text-danger]="activeSubscription.status === 'expired'">
            @if (activeSubscription.status === 'active') { {{ 'SUBSCRIPTION.STATUS.ACTIVE' | translate }} }
            @else if (activeSubscription.status === 'pending_activation') { {{ 'SUBSCRIPTION.STATUS.PENDING' | translate }} }
            @else { {{ 'SUBSCRIPTION.STATUS.EXPIRED' | translate }} }
          </span>
          <h5 class="m-0">{{ 'SUBSCRIPTION.DETAILS' | translate }}</h5>
        </div>

        <p><strong>{{ 'SUBSCRIPTION.NAME' | translate }}:</strong> {{ activeSubscription.name }}</p>

        <hr>
        <h6>{{ 'SUBSCRIPTION.FEATURES' | translate }}:</h6>
        <ul>
          @for (feature of activeSubscription.features; track feature) {
          <li>{{ feature }}</li>
          }
        </ul>
      </div>

      <!-- كود التفعيل -->
      @if (activeSubscription.status === 'pending_activation' && activeSubscription.activation_code) {
      <div class="p-4 border rounded-3 bg-light shadow-sm text-center" >
        <p>{{ 'SUBSCRIPTION.ACTIVATION_CODE' | translate }}</p>
        <h5 class="bg-success text-white px-3 py-2 rounded">
          #{{ activeSubscription.activation_code }}
        </h5>
        <p class="text-muted small">
          {{ 'SUBSCRIPTION.ACTIVATION_NOTE' | translate }}
        </p>
        <button class="btn btn-success w-100" (click)="visitBranch()">
          {{ 'SUBSCRIPTION.VIEW_BRANCHES' | translate }}
        </button>
      </div>
      }
    </div>
  </div>
  }

  <!-- لو مفيش اشتراك -->
  @if (!isLoading && !activeSubscription) {
  <div class="text-center p-5 border rounded-3">
    <img src="assets/Images/Subscriber-amico 2.svg" alt="no sub" class="mb-3" style="max-width:200px;">
    <p class="fw-bold">{{ 'SUBSCRIPTION.NO_ACTIVE' | translate }}</p>
    <p>{{ 'SUBSCRIPTION.CHOOSE_PACKAGE' | translate }}</p>
    <button class="btn btn-success" (click)="goToPackages()">{{ 'SUBSCRIPTION.VIEW_PACKAGES' | translate }}</button>
  </div>
  }
</div>
