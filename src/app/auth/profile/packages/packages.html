<div class="subscription-page" dir="rtl">

  <!-- حالة التحميل -->
  @if (isLoading) {
  <div class="text-center py-5">
    <div class="spinner-border text-success" role="status"></div>
  </div>
  }

  <!-- لو في اشتراك -->
  @if (!isLoading && activeSubscription) {
  <div class="row justify-content-center">
    <div class="col-md-8 d-flex gap-4">

      <!-- تفاصيل الاشتراك -->
      <div class="flex-grow-1 p-4 border rounded-3  ">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <span [class.text-success]="activeSubscription.status === 'active'"
            [class.text-warning]="activeSubscription.status === 'pending_activation'"
            [class.text-danger]="activeSubscription.status === 'expired'">
            @if (activeSubscription.status === 'active') { مفعل }
            @else if (activeSubscription.status === 'pending_activation') { في انتظار التفعيل }
            @else { منتهي }
          </span>
          <h5 class="m-0">تفاصيل الاشتراك</h5>
        </div>

        <p><strong>الاسم:</strong> {{ activeSubscription.name }}</p>

        <hr>
        <h6>المميزات:</h6>
        <ul>
          @for (feature of activeSubscription.features; track feature) {
          <li>{{ feature }}</li>
          }
        </ul>
      </div>

      <!-- كود التفعيل -->
      @if (activeSubscription.status === 'pending_activation' && activeSubscription.activation_code) {
      <div class="p-4 border rounded-3 bg-light shadow-sm text-center" style="min-width: 220px;">
        <p>كود التفعيل</p>
        <h5 class="bg-success text-white px-3 py-2 rounded">
          #{{ activeSubscription.activation_code }}
        </h5>
        <p class="text-muted small">
          يرجى زيارة أحد الفروع لتفعيل اشتراكك
        </p>
        <button class="btn btn-success w-100" (click)="visitBranch()">
          عرض جميع الفروع
        </button>
      </div>
      }
    </div>
  </div>
  }

  <!-- لو مفيش اشتراك -->
  @if (!isLoading && !activeSubscription) {
  <div class="text-center p-5 border rounded-3 ">
    <img src="assets/Images/Subscriber-amico 2.svg" alt="no sub" class="mb-3" style="max-width:200px;">
    <p class="fw-bold">أنت غير مشترك في أي باقة حاليًا.</p>
    <p>اختار الباقة اللي تناسبك وابدأ تجربتك معانا النهارده.</p>
    <button class="btn btn-success" (click)="goToPackages()">عرض الباقات</button>
  </div>
  }
</div>